= Kotlin Demo + Spring Boot

image:https://www.codefactor.io/repository/github/smougenot/kotlindemo/badge[Code Factor, link=https://www.codefactor.io/repository/github/smougenot/kotlindemo]
image:https://github.com/smougenot/kotlindemo/workflows/Gradle%20Build/badge.svg[Workflow build]
image:https://github.com/smougenot/kotlindemo/workflows/Gradle%20Release/badge.svg[Workflow release]

== Objectif

Présentation succincte de Kotlin, mise oeuvre autour de Spring Boot, JPA et REST

== Initialisation

À partir de https://start.spring.io/=!type=gradle-project&language=kotlin&platformVersion=2.4.2.RELEASE&packaging=jar&jvmVersion=11&groupId=fr.tse.jacademie&artifactId=kotlinDemo&name=kotlinDemo&description=Demo%20project%20for%20Spring%20Boot%20Kotlin&packageName=fr.tse.jacademie.kotlinDemo&dependencies=web,data-jpa,h2,actuator,data-rest-explorer,data-rest[start.spring.io] with Gradle, Kotlin, Java 11 +
Du code repris depuis les documentations référencées. +
Du code inspiré par les TPs de la JAcadémie.

== Kotlin en quelques mots

* Plus lisible
* Moins de code
* Plus de vérifications à la compilation
* Beaucoup de bonnes pratiques
* Tourne dans la JVM (interopérable)


=== Variable : Mutabilité explicite

Immutable
[source,Java]
----
val maConstante = "Never change"
val mesChoix = setOf("ras")

----

Mutable
[source,Java]
----
var maConstante = "Can change"
maConstante = "toto"

val mesChoix = mutableSetOf("ci")
mesChoix.add("ou ça")
----

=== Fonction

[source,Java]
----
fun nom(param: String): String {
  return "the result "
}
----

=== Null safe : à la compilation

[source,Java]
----
fun nom(nullable: String?, nonNull: String) {
  //...
}
----

=== Classe

* Multiples classes par fichier source
* Pas forcément de corps
* Finale par défaut

[source,Java]
----
open class ParentClass(val size: Int) {
    fun wontOverride() {
        // ...
    }

    open fun canOverride() {
        // ...
    }
}

class DescendantClass(aSize: Int) : ParentClass(aSize) {
    override fun canOverride() {
        // ...
    }
}

fun f() {
    val numberFour = DescendantClass(4)
}
----


=== Data class

* Pojo
* Immutable
* Finale

=== Paramètre nommés, valeurs par défaut

[source,Java]
----
data class MessageK(
  val from: String,
  val to: String,
  val title: String? = null,
  val cc: String? = null,
  val body: String? = null
)

val t = MessageK(from="From", to="To", cc="Cc")
----


=== String

Interpolation de variable
[source,Java]
----
val qui="who"
val msg="${qui.toUpperCase()} est sur la première base"
----


Multi-ligne litérale
[source,Java]
----
val texte = """
    Lorem ipsum dolor sit amet,
    consectetur adipiscing elit,
    sed do eiusmod tempor incididunt
    ut labore et dolore magna aliqua.
""".trimIndent()
----

=== Destructuration

=== Extension

=== Function de niveau supérieur

// TODO: à compléter

=== JPA

* `open` plugin `allopen`
* Mutable
  ** val -> var
  ** Set -> MutableSet

=== Test unitaire (Spring, MockBean)

* Nom de Méthode `\`ma methode\``

https://github.com/smougenot/KotlinDemo/blob/main/src/test/kotlin/fr/tse/jacademie/kotlinDemo/service/StudentServiceTest.kt[StudentServiceTest.kt]

=== Test d'intégration Web

https://github.com/smougenot/KotlinDemo/blob/main/src/test/kotlin/fr/tse/jacademie/kotlinDemo/web/StudentControllerIntegrationTest.kt[StudentControllerIntegrationTest.kt]


== References / documentation

* https://start.spring.io/[start.spring.io]
* https://kotlinlang.org/docs/reference/server-overview.html[Kotlin language]
* https://spring.io/guides/tutorials/spring-boot-kotlin/[Spring-boot Kotlin tutorial]
